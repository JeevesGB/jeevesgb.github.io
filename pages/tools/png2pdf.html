<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>IMG2PDF</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
    body {
        margin: 0;
        background: #1e1e1e;
        color: #ddd;
        font-family: Arial, sans-serif;
    }
    #container {
        display: flex;
        height: 100vh;
    }
    #left {
        width: 300px;
        padding: 10px;
        background: #252526;
        box-sizing: border-box;
    }
    #right {
        flex: 1;
        display: flex;
        justify-content: center;
        align-items: center;
        background: #2d2d2d;
    }
    button {
        width: 100%;
        margin-bottom: 6px;
        padding: 8px;
        background: #4fc3f7;
        border: none;
        font-weight: bold;
        cursor: pointer;
    }
    button:hover {
        background: #81d4fa;
    }
    ul {
        list-style: none;
        padding: 0;
        margin-top: 10px;
        max-height: 350px;
        overflow-y: auto;
        background: #1e1e1e;
    }
    li {
        padding: 6px;
        cursor: pointer;
        border-bottom: 1px solid #333;
    }
    li.selected {
        background: #4fc3f7;
        color: black;
    }
    canvas {
        background: #ddd;
    }
</style>
</head>
<body>

<div id="container">
    <div id="left">
        <button onclick="addImages()">Add Images</button>
        <button onclick="moveUp()">Move Up</button>
        <button onclick="moveDown()">Move Down</button>
        <button onclick="removeImage()">Remove Image</button>
        <button onclick="createPDF()">Create PDF</button>

        <ul id="list"></ul>
    </div>

    <div id="right">
        <canvas id="preview" width="400" height="400"></canvas>
    </div>
</div>

<input type="file" id="fileInput" accept="image/*" multiple hidden>

<script>
const images = [];
let selectedIndex = -1;

const list = document.getElementById("list");
const preview = document.getElementById("preview");
const ctx = preview.getContext("2d");

function addImages() {
    document.getElementById("fileInput").click();
}

document.getElementById("fileInput").addEventListener("change", e => {
    for (const file of e.target.files) {
        images.push(file);
    }
    refreshList();
});

function refreshList() {
    list.innerHTML = "";
    images.forEach((img, i) => {
        const li = document.createElement("li");
        li.textContent = img.name;
        if (i === selectedIndex) li.classList.add("selected");
        li.onclick = () => selectImage(i);
        list.appendChild(li);
    });
}

function selectImage(index) {
    selectedIndex = index;
    refreshList();
    showPreview(images[index]);
}

function moveUp() {
    if (selectedIndex <= 0) return;
    [images[selectedIndex - 1], images[selectedIndex]] =
        [images[selectedIndex], images[selectedIndex - 1]];
    selectedIndex--;
    refreshList();
}

function moveDown() {
    if (selectedIndex === -1 || selectedIndex >= images.length - 1) return;
    [images[selectedIndex + 1], images[selectedIndex]] =
        [images[selectedIndex], images[selectedIndex + 1]];
    selectedIndex++;
    refreshList();
}

function removeImage() {
    if (selectedIndex === -1) return;
    images.splice(selectedIndex, 1);
    selectedIndex = -1;
    refreshList();
    ctx.clearRect(0, 0, preview.width, preview.height);
}

function showPreview(file) {
    const img = new Image();
    img.onload = () => {
        ctx.clearRect(0, 0, preview.width, preview.height);
        const scale = Math.min(
            preview.width / img.width,
            preview.height / img.height
        );
        const w = img.width * scale;
        const h = img.height * scale;
        ctx.drawImage(img, (400 - w) / 2, (400 - h) / 2, w, h);
    };
    img.src = URL.createObjectURL(file);
}

async function createPDF() {
    if (!images.length) {
        alert("No images selected");
        return;
    }

    const { jsPDF } = window.jspdf;
    const pdf = new jsPDF("p", "pt", "a4");

    for (let i = 0; i < images.length; i++) {
        const img = await loadImage(images[i]);
        const ratio = Math.min(595 / img.width, 842 / img.height);
        const w = img.width * ratio;
        const h = img.height * ratio;

        if (i > 0) pdf.addPage();
        pdf.addImage(img, "JPEG", (595 - w) / 2, (842 - h) / 2, w, h);
    }

    pdf.save("output.pdf");
}

function loadImage(file) {
    return new Promise(resolve => {
        const img = new Image();
        img.onload = () => resolve(img);
        img.src = URL.createObjectURL(file);
    });
}
</script>
<p><a href="pages/webtools.html">← Go Back</a></p>
<footer>
  © 2025 JeevesGB
</footer>
</body>
</html>
