<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>TXT-2-CSV (Web)</title>

<style>
body {
    font-family: Arial, sans-serif;
    background: #1e1e1e;
    color: #ddd;
    margin: 20px;
}
select, input, button {
    background: #2b2b2b;
    color: #ddd;
    border: 1px solid #444;
    padding: 6px;
}
button {
    cursor: pointer;
    margin-top: 8px;
}
.container {
    max-width: 600px;
}
.scroll {
    max-height: 400px;
    overflow-y: auto;
    border: 1px solid #444;
    padding: 5px;
    margin-top: 10px;
}
.row {
    display: flex;
    margin-bottom: 4px;
}
.row label {
    width: 200px;
    font-size: 12px;
}
.row input {
    flex: 1;
}
</style>
</head>

<body>
<div class="container">
    <h2>TXT-2-CSV</h2>

    <label>Select Tab:</label><br>
    <select id="tabSelect"></select>

    <div class="scroll" id="inputArea"></div>

    <button onclick="exportCSV()">Generate CSV</button>
    <button onclick="importCSV()">Import CSV</button>

    <p id="status"></p>
</div>

<script>
/* ================= HEADERS ================= */

const headers = {
    "Brake": ["CarId", "Price", "Stage", "BrakingPower", "FrontBrakesUnknown", "RearBrakesUnknown"],
    "BrakeController": ["CarId", "Price", "Stage", "MaxFrontBias", "Unknown", "Unknown2", "DefaultBias", "MaxRearBias", "Unknown3", "Unknown4"],
    "Car": ["CarId", "Brake", "BrakeController", "Steer", "Chassis", "Lightweight", "RacingModify", "Engine", "PortPolish", "EngineBalance", "Displacement", "Computer", "NATune", "TurbineKit", "Drivetrain", "Flywheel", "Clutch", "PropellerShaft", "LSD", "Gear", "Suspension", "Intercooler", "Muffler", "TiresFront", "TiresRear", "ActiveStabilityControl", "TractionControlSystem", "RimsCode3", "ManufacturerID", "HasAllTiresBought", "Unknown", "Price"],
    "Chassis": ["CarId", "FrontWeightDistribution", "Unknown2", "FrontGrip", "RearGrip", "Length", "Height", "Wheelbase", "Weight", "TurningResistance", "PitchResistance", "RollResistance", "Unknown8"],
    "Clutch": ["CarId", "Price", "Stage", "RPMDropRate", "InertiaDisengaged", "InertiaEngaged", "InertialWeight", "InertiaBraking", "Unknown1", "Unknown2"],
    "Computer": ["CarId", "Price", "Stage", "PowerbandScaling", "RPMIncrease", "PowerMultiplier"],
    "Displacement": ["CarId", "Price", "Stage", "PowerbandScaling", "RPMIncrease", "PowerMultiplier"],
    "Drivetrain": ["CarId", "Unknown", "Unknown2", "Unknown3", "Unknown4", "DrivetrainType", "AWDBehaviour", "DefaultClutchRPMDropRate", "DefaultClutchInertiaEngaged", "DefaultClutchInertialWeight", "DefaultClutchInertiaDisengaged", "FrontDriveInertia", "RearDriveInertia"],
    "EnemyCars": ["CarId", "Brake", "BrakeController", "Steer", "Chassis", "Lightweight", "RacingModify", "Engine", "PortPolish", "EngineBalance", "Displacement", "Computer", "NATune", "TurbineKit", "Drivetrain", "Flywheel", "Clutch", "Propshaft", "LSD", "Gear", "Suspension", "Intercooler", "Muffler", "TiresFront", "TiresRear", "ActiveStabilityControl", "TractionControlSystem", "RimsCode3", "FinalDriveRatio", "GearAutoSetting", "LSDInitialFront", "LSDAccelFront", "LSDDecelFront", "LSDInitialRearAYCLevel", "LSDAccelRear", "LSDDecelRear", "DownforceFront", "DownforceRear", "CamberFront", "CamberRear", "ToeFront", "ToeRear", "RideHeightFront", "RideHeightRear", "SpringRateFront", "SpringRateRear", "DamperBoundFront1", "DamperBoundFront2", "DamperReboundFront1", "DamperReboundFront2", "DamperBoundRear1", "DamperBoundRear2", "DamperReboundRear1", "DamperReboundRear2", "StabiliserFront", "StabiliserRear", "ASMLevel", "TCSLevel", "Unknown3", "Unknown4", "PowerMultiplier", "OpponentId"],
    "Engine": ["CarId", "LayoutName", "ValvetrainName", "Aspiration", "SoundFile", "TorqueCurve1", "TorqueCurve2", "TorqueCurve3", "TorqueCurve4", "TorqueCurve5", "TorqueCurve6", "TorqueCurve7", "TorqueCurve8", "TorqueCurve9", "TorqueCurve10", "TorqueCurve11", "TorqueCurve12", "TorqueCurve13", "TorqueCurve14", "TorqueCurve15", "TorqueCurve16", "Displacement", "DisplayedPower", "MaxPowerRPM", "DisplayedTorque", "MaxTorqueRPMName", "PowerMultiplier", "ClutchReleaseRPM", "IdleRPM", "MaxRPM", "RedlineRPM", "TorqueCurveRPM1", "TorqueCurveRPM2", "TorqueCurveRPM3", "TorqueCurveRPM4", "TorqueCurveRPM5", "TorqueCurveRPM6", "TorqueCurveRPM7", "TorqueCurveRPM8", "TorqueCurveRPM9", "TorqueCurveRPM10", "TorqueCurveRPM11", "TorqueCurveRPM12", "TorqueCurveRPM13", "TorqueCurveRPM14", "TorqueCurveRPM15", "TorqueCurveRPM16", "TorqueCurvePoints"],
    "EngineBalance": ["CarId", "Price", "Stage", "PowerbandScaling", "RPMIncrease", "PowerMultiplier"],
    "Event": ["EventName", "TrackName", "Opponent1", "Opponent2", "Opponent3", "Opponent4", "Opponent5", "Opponent6", "Opponent7", "Opponent8", "Opponent9", "Opponent10", "Opponent11", "Opponent12", "Opponent13", "Opponent14", "Opponent15", "Opponent16", "RollingStartSpeed", "Laps", "AutoDrive", "Licence", "AIFrontGripRWD", "AIFrontGripFWD", "AIFrontGrip4WD", "AIFrontGripSpecial4WD", "AIRearGripRWD", "AIRearGripFWD", "AIRearGrip4WD", "AIRearGripSpecial4WD", "AIAccelerationRWD", "AIAccelerationFWD", "AIAcceleration4WD", "AIAccelerationSpecial4WD", "AIThrottleLiftReductionRWD", "AIThrottleLiftReductionFWD", "AIThrottleLiftReduction4WD", "AIThrottleLiftReductionSpecial4WD", "AIRubberBandMultiplier", "AIRubberBandUnknown1", "AIRubberBandScaledPerCar", "AIRubberBandLeadingSlowdownPercentage", "AIRubberBandLeadingScalingDistance", "AIRubberBandTrailingSpeedupPercentage", "AIRubberBandTrailingScalingDistance", "TireWearOrangeDurationMultiplier", "TireWearOrangeGripLoss", "TireWearUnknown", "TireWearBlueDurationMultiplier", "TireWearBlueGripLoss", "TireWearGreenDurationMultiplier", "TireWearGreenGripLoss", "Unknown1", "Unknown2", "Unknown3", "Unknown4", "IsRally", "EligibleCarsRestriction", "DrivetrainRestriction", "PrizeMoney1st", "PrizeMoney2nd", "PrizeMoney3rd", "PrizeMoney4th", "PrizeMoney5th", "PrizeMoney6th", "PrizeCars", "TrackBannerPool", "PSRestriction", "SeriesChampBonus", "CarRestrictionFlags"],
    "Flywheel": ["CarId", "Price", "Stage", "RPMDropRate", "ShiftDelay", "InertialWeight"],
    "Gear": ["CarId", "Price", "Stage", "NumberOfGears", "ReverseGearRatio", "FirstGearRatio", "SecondGearRatio", "ThirdGearRatio", "FourthGearRatio", "FifthGearRatio", "SixthGearRatio", "SeventhGearRatio", "DefaultFinalDriveRatio", "MaxFinalDriveRatio", "MinFinalDriveRatio", "AllowIndividualRatioAdjustments", "DefaultAutoSetting", "MinAutoSetting", "MaxAutoSetting"],
    "Intercooler": ["CarId", "Price", "Stage", "PowerbandScaling", "RPMIncrease", "PowerMultiplier"],
    "Lightweight": ["CarId", "Price", "Weight", "Unknown", "Stage"],
    "LSD": ["CarId", "Price", "Stage", "Unknown", "Unknown2", "Unknown3", "FrontUnknown", "DefaultInitialFront", "MinInitialFront", "MaxInitialFront", "DefaultAccelFront", "MinAccelFront", "MaxAccelFront", "DefaultDecelFront", "MinDecelFront", "MaxDecelFront", "RearUnknown", "DefaultInitialRear", "MinInitialRear", "MaxInitialRear", "DefaultAccelRear", "MinAccelRear", "MaxAccelRear", "DefaultDecelRear", "MinDecelRear", "MaxDecelRear"],
    "Muffler": ["CarId", "Price", "Stage", "PowerbandScaling", "RPMIncrease", "PowerMultiplier"],
    "NATune": ["CarId", "Price", "Stage", "PowerbandRPMIncrease", "RPMIncrease", "PowerMultiplier"],
    "PortPolish": ["CarId", "Price", "Stage", "PowerbandScaling", "RPMIncrease", "PowerMultiplier"],
    "PropellerShaft": ["CarId", "Price", "Stage", "RPMDropRate", "Inertia", "Inertia2"],
    "RacingModify": ["CarId", "Price", "BodyId", "Weight", "BodyRollAmount", "Stage", "Drag", "FrontDownforceMinimum", "FrontDownforceMaximum", "FrontDownforceDefault", "RearDownforceMinimum", "RearDownforceMaximum", "RearDownforceDefault", "Unknown3", "Unknown4", "Unknown5", "Unknown6", "Width"],
    "Regulations": ["EligibleCarIds"],
    "Steer": ["CarId", "Price", "Stage", "Unknown1", "Angle1Speed", "Angle2Speed", "Angle3Speed", "Angle4Speed", "Angle5Speed", "Angle6Speed", "Angle1", "Angle2", "Angle3", "Angle4", "Angle5", "Angle6", "MaxSteeringAngle", "Unknown2"],
    "Strings": ["CarID", "NameFirstPart", "NameSecondPart", "Year"],
    "Suspension": ["CarId", "Price", "Stage", "MinCamberFront", "MaxCamberFront", "DefaultCamberFront", "MinCamberRear", "MaxCamberRear", "DefaultCamberRear", "MinToeFront", "MaxToeFront", "MinToeRear", "MaxToeRear", "MinHeightFront", "MaxHeightFront", "DefaultHeightFront", "MinHeightRear", "MaxHeightRear", "DefaultHeightRear", "DampingFront", "DampingRear", "TravelFront", "TravelRear", "MinSpringRateFront", "MaxSpringRateFront", "DefaultSpringRateFront", "MinSpringRateRear", "MaxSpringRateRear", "DefaultSpringRateRear", "SpringFrequencyFront", "SpringFrequencyRear", "Unknown7", "Unknown8", "MaxDamperBoundFront", "Unknown9", "Unknown10", "DefaultDamperBoundFront", "Unknown11", "Unknown12", "Unknown13", "MaxDamperReboundFront", "Unknown14", "Unknown15", "DefaultDamperReboundFront", "Unknown16", "Unknown17", "Unknown18", "MaxDamperBoundRear", "Unknown19", "Unknown20", "DefaultDamperBoundRear", "Unknown21", "Unknown22", "Unknown23", "MaxDamperReboundRear", "Unknown24", "Unknown25", "DefaultDamperReboundRear", "Unknown26", "Unknown27", "Unknown28", "MaxStabiliserFront", "Unknown29", "Unknown30", "DefaultStabiliserFront", "MaxStabiliserRear", "Unknown31", "Unknown32", "DefaultStabiliserRear", "Unknown33"],
    "TireSize": ["DiameterInches", "WidthMM", "Profile"],
    "TiresFront": ["CarId", "Price", "Stage", "SteeringReaction1", "WheelSize", "SteeringReaction2", "TireCompound", "TireForceVolMaybe", "SlipMultiplier", "GripMultiplier"],
    "TiresRear": ["CarId", "Price", "Stage", "SteeringReaction1", "WheelSize", "SteeringReaction2", "TireCompound", "TireForceVolMaybe", "SlipMultiplier", "GripMultiplier"],
    "TurbineKit": ["CarId", "Price", "Stage", "BoostGaugeLimit", "LowRPMBoost", "HighRPMBoost", "SpoolRate", "Unknown1", "Unknown2", "Unknown3", "RPMIncrease", "RedlineIncrease", "HighRPMPowerMultiplier", "LowRPMPowerMultiplier"],
    "Wheel": ["WheelId", "StageMaybe", "Unknown", "Unknown2", "Unknown3"]
};


/* ================= INIT ================= */
const tabSelect = document.getElementById("tabSelect");
const inputArea = document.getElementById("inputArea");
const status = document.getElementById("status");

Object.keys(headers).forEach(key => {
    const opt = document.createElement("option");
    opt.value = key;
    opt.textContent = key;
    tabSelect.appendChild(opt);
});

tabSelect.addEventListener("change", buildFields);
tabSelect.selectedIndex = 0;
buildFields();

/* ================= BUILD INPUTS ================= */
function buildFields() {
    inputArea.innerHTML = "";
    const selected = tabSelect.value;

    headers[selected].forEach(h => {
        const row = document.createElement("div");
        row.className = "row";

        const label = document.createElement("label");
        label.textContent = h;

        const input = document.createElement("input");
        input.dataset.header = h;

        row.appendChild(label);
        row.appendChild(input);
        inputArea.appendChild(row);
    });
}

/* ================= EXPORT CSV ================= */
function exportCSV() {
    const selected = tabSelect.value;
    const cols = headers[selected];
    const inputs = [...inputArea.querySelectorAll("input")];

    const values = inputs.map(i => i.value);
    const csv = [
        cols.join(","),
        values.map(v => `"${v.replace(/"/g, '""')}"`).join(",")
    ].join("\n");

    const blob = new Blob([csv], { type: "text/csv" });
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = `${selected}.csv`;
    a.click();

    status.textContent = "CSV generated.";
}

/* ================= IMPORT CSV ================= */
function importCSV() {
    const input = document.createElement("input");
    input.type = "file";
    input.accept = ".csv";

    input.onchange = () => {
        const file = input.files[0];
        const reader = new FileReader();

        reader.onload = () => {
            const lines = reader.result.split(/\r?\n/);
            if (lines.length < 2) {
                alert("Invalid CSV");
                return;
            }

            const values = lines[1].split(",");
            const inputs = [...inputArea.querySelectorAll("input")];

            inputs.forEach((inp, i) => {
                if (values[i]) inp.value = values[i].replace(/^"|"$/g, "");
            });

            status.textContent = "CSV imported.";
        };

        reader.readAsText(file);
    };

    input.click();
}
</script>
<p><a href="pages/webtools.html">← Go Back</a></p>
<footer>
  © 2025 JeevesGB
</footer>
</body>
</html>
